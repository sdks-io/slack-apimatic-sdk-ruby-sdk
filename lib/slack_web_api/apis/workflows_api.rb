# slack_web_api
#
# This file was automatically generated by APIMATIC v3.0 (
# https://www.apimatic.io ).

module SlackWebApi
  # WorkflowsApi
  class WorkflowsApi < BaseApi
    # Indicate that an app's step in a workflow completed execution.
    # @param [String] token Required parameter: Authentication token. Requires
    # scope: `workflow.steps:execute`
    # @param [String] workflow_step_execute_id Required parameter: Context
    # identifier that maps to the correct workflow step execution.
    # @param [String] outputs Optional parameter: Key-value object of outputs
    # from your step. Keys of this object reflect the configured `key`
    # properties of your [`outputs`](/reference/workflows/workflow_step#output)
    # array from your `workflow_step` object.
    # @return [ApiResponse] Complete http response with raw body and status code.
    def workflows_step_completed(token,
                                 workflow_step_execute_id,
                                 outputs: nil)
      @api_call
        .request(new_request_builder(HttpMethodEnum::GET,
                                     '/workflows.stepCompleted',
                                     Server::DEFAULT)
                   .header_param(new_parameter(token, key: 'token')
                                  .is_required(true))
                   .query_param(new_parameter(workflow_step_execute_id, key: 'workflow_step_execute_id')
                                 .is_required(true))
                   .header_param(new_parameter('application/x-www-form-urlencoded', key: 'Content-Type'))
                   .query_param(new_parameter(outputs, key: 'outputs'))
                   .header_param(new_parameter('application/json', key: 'accept'))
                   .auth(Single.new('slackAuth')))
        .response(new_response_handler
                    .deserializer(APIHelper.method(:custom_type_deserializer))
                    .deserialize_into(DefaultSuccessTemplate.method(:from_hash))
                    .is_api_response(true)
                    .local_error('default',
                                 'Typical error response',
                                 DefaultErrorTemplateException))
        .execute
    end

    # Indicate that an app's step in a workflow failed to execute.
    # @param [String] token Required parameter: Authentication token. Requires
    # scope: `workflow.steps:execute`
    # @param [String] workflow_step_execute_id Required parameter: Context
    # identifier that maps to the correct workflow step execution.
    # @param [String] error Required parameter: A JSON-based object with a
    # `message` property that should contain a human readable error message.
    # @return [ApiResponse] Complete http response with raw body and status code.
    def workflows_step_failed(token,
                              workflow_step_execute_id,
                              error)
      @api_call
        .request(new_request_builder(HttpMethodEnum::GET,
                                     '/workflows.stepFailed',
                                     Server::DEFAULT)
                   .header_param(new_parameter(token, key: 'token')
                                  .is_required(true))
                   .query_param(new_parameter(workflow_step_execute_id, key: 'workflow_step_execute_id')
                                 .is_required(true))
                   .query_param(new_parameter(error, key: 'error')
                                 .is_required(true))
                   .header_param(new_parameter('application/x-www-form-urlencoded', key: 'Content-Type'))
                   .header_param(new_parameter('application/json', key: 'accept'))
                   .auth(Single.new('slackAuth')))
        .response(new_response_handler
                    .deserializer(APIHelper.method(:custom_type_deserializer))
                    .deserialize_into(DefaultSuccessTemplate.method(:from_hash))
                    .is_api_response(true)
                    .local_error('default',
                                 'Typical error response',
                                 DefaultErrorTemplateException))
        .execute
    end

    # Update the configuration for a workflow extension step.
    # @param [String] token Required parameter: Authentication token. Requires
    # scope: `workflow.steps:execute`
    # @param [String] workflow_step_edit_id Required parameter: A context
    # identifier provided with `view_submission` payloads used to call back to
    # `workflows.updateStep`.
    # @param [String] inputs Optional parameter: A JSON key-value map of inputs
    # required from a user during configuration. This is the data your app
    # expects to receive when the workflow step starts. **Please note**: the
    # embedded variable format is set and replaced by the workflow system. You
    # cannot create custom variables that will be replaced at runtime. [Read
    # more about variables in workflow steps
    # here](/workflows/steps#variables).
    # @param [String] outputs Optional parameter: An JSON array of output
    # objects used during step execution. This is the data your app agrees to
    # provide when your workflow step was executed.
    # @param [String] step_name Optional parameter: An optional field that can
    # be used to override the step name that is shown in the Workflow Builder.
    # @param [String] step_image_url Optional parameter: An optional field that
    # can be used to override app image that is shown in the Workflow Builder.
    # @return [ApiResponse] Complete http response with raw body and status code.
    def workflows_update_step(token,
                              workflow_step_edit_id,
                              inputs: nil,
                              outputs: nil,
                              step_name: nil,
                              step_image_url: nil)
      @api_call
        .request(new_request_builder(HttpMethodEnum::GET,
                                     '/workflows.updateStep',
                                     Server::DEFAULT)
                   .header_param(new_parameter(token, key: 'token')
                                  .is_required(true))
                   .query_param(new_parameter(workflow_step_edit_id, key: 'workflow_step_edit_id')
                                 .is_required(true))
                   .header_param(new_parameter('application/x-www-form-urlencoded', key: 'Content-Type'))
                   .query_param(new_parameter(inputs, key: 'inputs'))
                   .query_param(new_parameter(outputs, key: 'outputs'))
                   .query_param(new_parameter(step_name, key: 'step_name'))
                   .query_param(new_parameter(step_image_url, key: 'step_image_url'))
                   .header_param(new_parameter('application/json', key: 'accept'))
                   .auth(Single.new('slackAuth')))
        .response(new_response_handler
                    .deserializer(APIHelper.method(:custom_type_deserializer))
                    .deserialize_into(DefaultSuccessTemplate.method(:from_hash))
                    .is_api_response(true)
                    .local_error('default',
                                 'Typical error response',
                                 DefaultErrorTemplateException))
        .execute
    end
  end
end
